--aplicar drop tabela no owner D_PST_BSN_CREDITO_T
 DROP TABLE D_PST_BSN_CREDITO_T.PAINEL_VEICULOS_GARANTIAS;

 -- recriar a tabela no owner APP_CREDITO
DROP TABLE D_APP_CREDITO_T.PAINEL_VEICULOS_GARANTIAS;
CREATE MULTISET TABLE D_APP_CREDITO_T.PAINEL_VEICULOS_GARANTIAS
     (
    COD_CENTRAL VARCHAR(4),
	NOME_CENTRAL VARCHAR(255),
	COD_COOP VARCHAR(4),
	NOME_COOP VARCHAR(255),
	COD_AGENCIA VARCHAR(2),
	NOME_AGENCIA VARCHAR(255),
	COD_CARTEIRA VARCHAR(3),
	NOME_CARTEIRA VARCHAR(30),
    GESTOR_CARTEIRA VARCHAR(60),
	COOP  VARCHAR(4),
	RECNO NUMBER(10,0), 
	FCCODTITU VARCHAR(10), 
	FCPARCELAS VARCHAR(3), 
	FNTXJRNOR NUMBER(12,6), 
	FNVLRFINAN NUMBER(15,2), 
	FNVLRLIBER NUMBER(15,2), 
	FNSALDOON NUMBER(16,2), 
	FDDTALIBER TIMESTAMP(0), 
	FDDTAVENC TIMESTAMP(0), 
	COD_PRODUTO VARCHAR(4),
	NOME_PRODUTO VARCHAR(58),
    TIPO_PRODUTO VARCHAR(20),
	GRUPO1_MATURACAO VARCHAR(27),
	GRUPO2_MATURACAO VARCHAR(45),
	FCCODEMPRE VARCHAR(8), 
	FCSITUACAO VARCHAR(1),
	FCCODASSO VARCHAR(6),
	FCONTA VARCHAR(7),  
    FCPF_CGC VARCHAR(18), 
    FDATAABERT TIMESTAMP(0), 
    FNOME VARCHAR(50),
    COD_GARANTIA VARCHAR(5), 
    FCCODBEM VARCHAR(3),
    FCDESC VARCHAR(35), 
	FNVALOR NUMBER(16,2), 
   	FCMARCAVE VARCHAR(30), 
   	FCANOVEIC VARCHAR(4), 
   	FCCHASSIM VARCHAR(20), 
    FCRENAVAM  VARCHAR(20), 
    FCPLACA VARCHAR(7), 
    FCCATVEICU VARCHAR(10), 
    FCANOMODFB VARCHAR(4),
	DATA_PROCESSAMENTO DATE DEFAULT CURRENT_DATE
      )
PRIMARY INDEX (COD_CENTRAL,COD_COOP,COD_AGENCIA,COD_CARTEIRA,COD_PRODUTO,TIPO_PRODUTO)
PARTITION BY  (RANGE_N(CAST((COD_COOP) AS INTEGER) BETWEEN 1 AND 9999 EACH 1, UNKNOWN)); 


COLLECT STATISTICS 
            COLUMN (PARTITION) , 
            COLUMN (COD_COOP, COD_AGENCIA),
			COLUMN (COD_AGENCIA)
                ON D_APP_CREDITO_T.PAINEL_VEICULOS_GARANTIAS; 

-- VIEW
REPLACE VIEW D_APP_CREDITO_V.VW_PAINEL_VEICULOS_GARANTIAS
(    
    COD_CENTRAL,
	NOME_CENTRAL,
	COD_COOP,
	NOME_COOP,
	COD_AGENCIA,
	NOME_AGENCIA,
	COD_CARTEIRA,
	NOME_CARTEIRA,
    GESTOR_CARTEIRA, 
	COOP,
	RECNO, 
	FCCODTITU, 
	FCPARCELAS, 
	FNTXJRNOR, 
	FNVLRFINAN, 
	FNVLRLIBER, 
	FNSALDOON, 
	FDDTALIBER, 
	FDDTAVENC, 
	COD_PRODUTO,
	NOME_PRODUTO,
    TIPO_PRODUTO,
	GRUPO1_MATURACAO,
	GRUPO2_MATURACAO,
	FCCODEMPRE, 
	FCSITUACAO,
	FCCODASSO,
	FCONTA,  
    FCPF_CGC, 
    FDATAABERT, 
    FNOME,
    COD_GARANTIA, 
    FCCODBEM,
    FCDESC, 
	FNVALOR, 
   	FCMARCAVE, 
   	FCANOVEIC, 
   	FCCHASSIM, 
    FCRENAVAM, 
    FCPLACA, 
    FCCATVEICU, 
    FCANOMODFB,
	DATA_PROCESSAMENTO
)	  

AS LOCKING ROW FOR ACCESS
SELECT
    COD_CENTRAL,
	NOME_CENTRAL,
	COD_COOP,
	NOME_COOP,
	COD_AGENCIA,
	NOME_AGENCIA,
	COD_CARTEIRA,
	NOME_CARTEIRA,
    GESTOR_CARTEIRA, 
	COOP,
	RECNO, 
	FCCODTITU, 
	FCPARCELAS, 
	FNTXJRNOR, 
	FNVLRFINAN, 
	FNVLRLIBER, 
	FNSALDOON, 
	FDDTALIBER, 
	FDDTAVENC, 
	COD_PRODUTO,
	NOME_PRODUTO,
    TIPO_PRODUTO,
	GRUPO1_MATURACAO,
	GRUPO2_MATURACAO,
	FCCODEMPRE, 
	FCSITUACAO,
	FCCODASSO,
	FCONTA,  
    FCPF_CGC, 
    FDATAABERT, 
    FNOME,
    COD_GARANTIA, 
    FCCODBEM,
    FCDESC, 
	FNVALOR, 
   	FCMARCAVE, 
   	FCANOVEIC, 
   	FCCHASSIM, 
    FCRENAVAM, 
    FCPLACA, 
    FCCATVEICU, 
    FCANOMODFB,
    DATA_PROCESSAMENTO	
FROM D_APP_CREDITO_T.PAINEL_VEICULOS_GARANTIAS;